# VHDL硬件描述语言基础

[TOC]

## 1. VHDL语言相关知识

1. VHDL是VHSIC HDL（超高速集成电路硬件描述语言）的缩写。
2. FPGA电路设计的抽象层次：行为层次、寄存器传输层次（RTL）、逻辑门层次、布图层次。FPGA设计需要设计到RTL以上的层次实现，底层通过综合工具和实现工具完成。
	> 行为层次主要关注模块的功能描述和仿真验证，全部建模语句均可使用；
	> 寄存器传输层次主要关注模块的可综合电路的实现，只能用可综合的语句；
	> 逻辑门层次考虑如何用门级电路实现给定功能；
	> 布图层次考虑如何将电路适配到FPGA的资源中。

## 2. VHDL语言设计的基本的单元

1. VHDL是由设计单元组成的，基本设计单元包括：实体（Entity）、构造体（Architecture）、配置（Configuration）、包集合（Package）、库（Library）。
2. 实体：实体描述了模块的标识（实体名称）、模块的外部接口以及接口的相关参数。
	- 语句格式如下：
		```VHDL
		entity 实体名称 is
			generic( 参数名称: 参数类型 [:= 默认值];
					 参数名称: 参数类型 [:= 默认值];
					 ......
					 参数名称: 参数类型 [:= 默认值]);
			port( 端口名称{, 端口名称, ...}: 端口模式 数据类型;
				  端口名称{, 端口名称, ...}: 端口模式 数据类型;
				  ......
				  端口名称{, 端口名称, ...}: 端口模式 数据类型);
		end 实体名称;
		```
	- generic部分为参数声明，由三部分构成：参数名称、参数类型、参数默认值，其中参数的默认值是可选的。实体内部声明的参数可作为常数使用。generic必须放在port之前。实体在其他模块中被例化或者使用配置时，参数将被传递进来，如果在例化或配置时没有传递参数，则参数保持为默认值。
	- port部分为端口声明部分，由三部分构成：端口名称、端口模式、数据类型。
	- 端口模式用于定义模块端口的数据传输模式，VHDL的端口模式共有5种：in，out，inout，buffer，linkage。
		|模式|含义|
		|------|------|
		|in|输入，只能被读取，不能被赋值|
		|out|输出，只能被赋值，不能被读取|
		|inout|双向，可以被读取也可以被赋值，读取的是输入值，而不是所赋的值|
		|buffer|缓冲输出，类似于out，但值可以被读取，读取的是被赋的值;</br>当一个实体的端口用buffer模式时，只能与其他实体的buffer类型端口相连|
		|linkage|不指定方向，可以与任意类型端口相连|
	- 端口数据类型：支持标准逻辑类型，包括布尔型（boolean）、位型（bit）、位矢量型（bit_vector）、整数型（integer）。使用这些逻辑类型前，必须声明IEEE库（IEEE std_logic_1164）。
		```VHDL
		// 声明库
		library IEEE;
		use IEEE.STD_LOGIC_1164.all;

		// 数据类型的表达方式：数据类型标识(高位 downto 低位)
		// 数据类型标识  位型——STD_LOGIC
		//			   位矢量——STD_LOGIC_VECTOR
		```
3. 构造体：构造体描述了模块的内部功能、行为或结构实现。构造体是一个从属单元，须与实体声明联合使用，一个实体声明可对应多个构造体。
	- 语句格式如下：
		```VHDL
		architecture 构造体名称 of 实体名称 is
			{声明语句;}
		begin
			{并发语句;}
		end 构造体名称;
		```
	- 构造体在描述模块内部实现时通常有三种方式：行为描述、数据流描述、结构描述。
		|描述方式|特点|
		|------|------|
		|行为描述|抽象层最高的描述，描述使用电路的行为特性，通常用process方式进行描述|
		|数据流描述|使用标准布尔函数，将信号间的布尔代数关系用布尔方程式来表示|
		|结构描述|主要通过下层模块的声明和调用及端口映射将下层模块相连，构成结构性描述|
	- 声明语句：位于begin之前，可用于声明下列描述语句：
		- “use”语句；
		- 子程序声明；
		- 子程序体；
		- 类型声明；
		- 子类型声明；
		- 常量声明；
		- 信号声明；
		- 元件声明；
		- 并发语句。
	- 并发语句：每个并发语句都定义了一个运算单元